<!DOCTYPE html>
<html>
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KW5Z8F8TWV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-KW5Z8F8TWV');
  </script>
  <title>Characters AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/styles-copy.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script> <!--Подключаем скрипт от телеграм-->
  <link href="https://fonts.googleapis.com/css2?family=San+Francisco&display=swap" rel="stylesheet">
  <!-- <script>
  let bG;
  let userId;
  let tg = window.Telegram.WebApp;
  tg.expand();
  userId = tg.initDataUnsafe.user.id;
  bG = tg.colorScheme
  function sendRequest() {
        var xhr = new XMLHttpRequest();

        xhr.open('GET', 'https://ai-bot-sintecs.amvera.io/site_loaded?user_id=' + encodeURIComponent(userId) + '&site_tab=favourite&bg_color=' + encodeURIComponent(bG), true);
        xhr.send();
    }

  function doSomethingWhenPageIsLoaded() {
        sendRequest();
    }
</script> -->
  <style>
    body{
       color: var(--tg-theme-text-color);
       background: var(--tg-theme-bg-color);
    }

    .hint{
       color: var(--tg-theme-hint-color);
    }

    .link{
       color: var(--tg-theme-link-color);
    }

    h1 {
      color: var(--tg-theme-text-color);
    }
    h2 {
        color: var(--tg-theme-text-color);
    }
    .btn{
      border: 2px solid var(--tg-theme-button-color);
       background: var(--tg-theme-button-color);
       color: var(--tg-theme-button-text-color);
    }
    .fixed-button{
      border: 1px solid var(--tg-theme-button-color);
       background: var(--tg-theme-button-color);
       color: var(--tg-theme-button-text-color);
    }
    .btn-primary:hover {
      background-color: var(--tg-theme-hover-color);
    }
  .btn.active.bg-primary {
    box-shadow: none !important;
    outline: none !important;
    border: 3px solid var(--tg-theme-button-color) !important;
    background-color: var(--tg-theme-bg-color) !important;
    color: var(--tg-theme-button-color) !important;
      }
 </style>
</head>
<body onload="doSomethingWhenPageIsLoaded();">

  <div class="container">
    <div class="row">
      <!-- Создание 17 кнопок -->
      {% for name, username, char_id, actions_count, chars_activity, url in values %}
      <div class="col-md-6">
        <button id="c{{ char_id }}" class="btn btn-primary btn-block mb-3 mx-auto d-block" onclick="redirectToAllChar('{{ char_id }}')" style="background-image: url('static/{{ url }}'); background-size: cover;">
          <!-- Вставьте текст или иконку для кнопки здесь -->
        </button>
        <h1>{{ name }}</h1>
        <h2>{{ chars_activity }}<br></h2>
        <div style="display: flex; align-items: center; justify-content: center;">
          <h2 style="display: inline-block; margin-right: 1vh;">{{ actions_count }}</h2>
          <img src="static/img/chat1.svg" alt="Описание изображения" style="display: inline-block; width: 2vh; height: auto;">
        </div>
        </div>
      {% endfor %}
      </div>
  </div>
</div>

<div class="btn-container">
  <button id="first-button" class="btn fixed-button mx-auto d-block bg-primary active" onclick="redirectToAll_list()">Избранные</button>
  <button id="second-button" class="btn fixed-button mx-auto d-block" onclick="redirectToFavorites()">Боты сообщества</button>
</div>
<script>
  let bG;
  let userId;
  let bg_color;
  let text_color;
  let hint_color;
  let link_color;
  let button_color;
  let tg = window.Telegram.WebApp;
  tg.expand();
  bG = tg.colorScheme
  bg_color = tg.ThemeParams.bg_color;
  text_color = tg.ThemeParams.text_color;
  hint_color = tg.ThemeParams.hint_color;
  userId = tg.initDataUnsafe.user.id;
  link_color = tg.ThemeParams.link_color;
  button_color = tg.ThemeParams.button_color;
  function redirectToAll_list() {
    var url = 'https://ai-bot-sintecs.amvera.io/';
    window.location.href = url;
  }
  function redirectToFavorites() {
    var url = 'https://ai-bot-sintecs.amvera.io/favorites?value=' + encodeURIComponent(userId);
    window.location.href = url;
  }
  function redirectToAllChar(charId) {
    var url = 'http://65.108.53.155:8081/set_char?user_id=' + encodeURIComponent(userId) + '&char_id=' + encodeURIComponent(charId);
    window.location.href = url;
    setTimeout(function() {
      tg.close();
    }, 2000);
  }
  function sendRequest() {
    var xhr = new XMLHttpRequest();

    // xhr.open('GET', 'http://localhost:8080/site_loaded?user_id=' + encodeURIComponent(userId) + '&site_tab=favourite&bg_color=' + encodeURIComponent(bG), true);
    // xhr.open('GET', 'https://ai-bot-sintecs.amvera.io/site_loaded?user_id=' + encodeURIComponent(userId) + '&site_tab=favourite&bg_color=' + encodeURIComponent(bG), true);
    var url = 'https://ai-bot-sintecs.amvera.io/site_loaded?user_id=' + encodeURIComponent(userId) +
      '&site_tab=favourite' +
      '&bg_color=' + encodeURIComponent(bG) +
      '&text_color=' + encodeURIComponent(text_color) +
      '&hint_color=' + encodeURIComponent(hint_color) +
      '&link_color=' + encodeURIComponent(link_color) +
      '&button_color=' + encodeURIComponent(button_color)+
      '&backgound_color=' + encodeURIComponent(bg_color);
    xhr.open('GET', url, true);
    xhr.send();
}

  function doSomethingWhenPageIsLoaded() {
        sendRequest();
    }
</script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
